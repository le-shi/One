# 快速测试两台服务器之间的网络速度

快速发现两个 Linux 服务器之间的速度通常是复制大文件的苦差事。

[iperf](https://iperf.fr/)有更好的方法。

`iperf` 可用于在两台 Linux 服务器上快速设置服务器和客户端进程，并报告它们之间的最大网络吞吐量。

## 安装

```bash
# CentOS7
sudo yum install iperf
# Rocky8 | CentOS8
sudo dnf install iperf3
# Ubuntu | Linux Mint
sudo apt install iperf
```


## 服务器

在服务器机器上运行以下命令：

```bash
iperf -s -i 10
```

- `-s` - 创建一个将侦听 TCP 5001 的服务器。
- `-i 10` - 每 10 秒打印一份速度报告。

## 客户端

在客户端运行以下命令：

```bash
iperf -i 10 -c <SERVER>
```

- `-i` - 每 10 秒打印一份速度报告。
- `-c` - 服务器的 IP 或主机名。

## 结果

每 10 秒测量的网络速度将打印在客户端和服务器上。这是服务器在我的测试机器上的输出：

```bash
# iperf -s -i 10
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size:  128 KByte (default)
------------------------------------------------------------
[  4] local 1.1.1.1 port 5001 connected with 2.2.2.2 port 36172
[ ID] Interval       Transfer     Bandwidth
[  4] 0.0000-10.0000 sec  2.27 GBytes  1.95 Gbits/sec
[  4] 0.0000-10.0163 sec  2.27 GBytes  1.84 Gbits/sec
[  4] 0.0000-10.0163 sec  2.27 GBytes  1.95 Gbits/sec
```

我在这些机器之间获得了 ~1.9Gbits/sec 的速度。